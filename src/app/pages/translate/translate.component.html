<ng-container *transloco="let t; read: 'translate'">
  <mat-toolbar>
    <mat-icon>translate</mat-icon>
    <span>{{t('title')}}</span>
  </mat-toolbar>

  <div id="container">
    <div id="input-mode-group">
      <ng-container *ngIf="spokenToSigned">
        <button mat-stroked-button color="primary" (click)="setInputMode('text')"
                [class.selected]="inputMode === 'text'">
          <mat-icon>translate</mat-icon>
          {{t('input.text')}}
        </button>
      </ng-container>
      <ng-container *ngIf="!spokenToSigned">
        <button mat-stroked-button color="primary" (click)="setInputMode('webcam')"
                [class.selected]="inputMode === 'webcam'">
          <mat-icon>videocam</mat-icon>
          {{t('input.webcam')}}
        </button>
        <button mat-stroked-button color="primary" (click)="setInputMode('upload')"
                [class.selected]="inputMode === 'upload'">
          <mat-icon>upload</mat-icon>
          {{t('input.upload')}}
        </button>
      </ng-container>
    </div>

    <div id="translation-card">
      <div id="language-selector">
        <app-language-selector [flags]="true" [languages]="signedLanguages" translationKey="translate.languages.signed"
                               [hasLanguageDetection]="!spokenToSigned"></app-language-selector>

        <!-- disabled -->
        <button mat-icon-button (click)="swapLanguages()" [matTooltip]="t('swapLanguages')" id="swap-languages">
          <mat-icon>swap_horiz</mat-icon>
        </button>

        <app-language-selector [languages]="spokenLanguages" translationKey="translate.languages.spoken"
                               [hasLanguageDetection]="spokenToSigned"></app-language-selector>
      </div>

      <div id="content">
        <!-- Spoken to sign requires a text input and video output -->
        <ng-container *ngIf="spokenToSigned">
          <div class="translation-text">
            <textarea></textarea>
          </div>
          <div class="sign-writing">
            <sgnw-sign *ngFor="let sign of this.signWriting" [attr.fsw]="sign"></sgnw-sign>
          </div>
          <div class="sign-language">
            <img src="https://explorit.ch/wp-content/uploads/2019/10/placeholder.png" width="100%">
          </div>
        </ng-container>

        <!-- Sign to spoken requires a video output and text output -->
        <ng-container *ngIf="!spokenToSigned">
          <ng-container *ngIf="inputMode === 'upload'">
            <ng-container *ngIf="videoState$ | async as videoState">
              <app-upload *ngIf="!videoState.src"></app-upload>
              <ng-container *ngIf="videoState.src">
                <div class="sign-language">
                  <app-video [displayControls]="false" [displayFps]="false"></app-video>
                </div>
                <div class="sign-writing">
                  <sgnw-sign *ngFor="let sign of this.signWriting" [attr.fsw]="sign"></sgnw-sign>
                </div>
                <div class="translation-text">{{translation}}</div>
              </ng-container>
            </ng-container>
          </ng-container>

          <ng-container *ngIf="inputMode === 'webcam'">
            <div class="sign-language">
              <app-video [displayControls]="false" [displayFps]="false"></app-video>
            </div>
            <div class="translation-text">Translation</div>
          </ng-container>
        </ng-container>
      </div>
    </div>

    <a id="feedback" href="mailto:amitmoryossef@gmail.com?subject=Sign Language Translate Feedback">
      {{t('feedback')}}
    </a>
  </div>
</ng-container>
